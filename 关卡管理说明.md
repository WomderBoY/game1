# 关卡管理系统使用说明（简化版）

## 概述
简化后的关卡管理系统使用JavaScript初始化脚本直接提供关卡配置，避免了CORS问题和复杂的动态加载逻辑。

## 当前生效的方案
**方案：从localStorage加载配置**
- `init-config.js` 在页面加载时初始化关卡配置
- 配置保存到localStorage
- `level-select.js` 从localStorage读取配置
- 无需服务器环境，可直接在浏览器中运行

## 文件结构
- `init-config.js` - 关卡配置初始化脚本（主要配置文件）
- `level-select.js` - 关卡选择界面脚本（已简化）
- `level-select.html` - 关卡选择页面

## 添加新关卡

### 方法：修改init-config.js
在 `init-config.js` 中的 `DEFAULT_LEVELS_CONFIG.levels` 数组添加新的关卡对象：

```javascript
{
    "id": "bg_map5",
    "file": "../map/bg-map5.json", 
    "name": "第五关",
    "unlocked": false,
    "order": 7
}
```

## 关卡配置字段说明

- `id`: 关卡唯一标识符（英文，建议使用下划线分隔）
- `file`: 关卡JSON文件的相对路径
- `name`: 关卡显示名称（中文）
- `unlocked`: 是否默认解锁（通常只有第一关设为true）
- `order`: 关卡顺序（数字，系统会自动重新排序）

## 优势

- ✅ **简单可靠**: 无需服务器环境，直接在浏览器中运行
- ✅ **无CORS问题**: 避免了fetch加载JSON文件的跨域问题
- ✅ **自动计数**: 关卡数量自动计算，无需手动修改硬编码数字
- ✅ **动态生成**: HTML界面自动生成，无需手动添加按钮
- ✅ **易于维护**: 添加关卡只需修改一个JavaScript文件

## 注意事项

1. **ID唯一性**: 每个关卡的ID必须唯一
2. **文件路径**: 确保关卡文件路径正确
3. **配置同步**: 修改配置后，需要刷新页面才能生效
4. **默认解锁**: 只有第一关默认解锁，其他关卡需要玩家通过游戏解锁

## 示例：添加新关卡完整流程

1. 创建关卡JSON文件 `work/map/bg-map5.json`
2. 在 `init-config.js` 中添加关卡配置
3. 刷新关卡选择页面，新关卡会自动显示
4. 无需修改任何其他代码文件

## 故障排除

如果关卡没有正确显示：
1. 检查浏览器控制台是否有错误信息
2. 确认 `init-config.js` 已正确加载
3. 检查localStorage中是否有 `levelsConfig` 数据
4. 刷新页面重新加载配置
