这个是写注释的，不然结构多了容易忘记

## game
this.lst没用到，是多余的
this.status 运行状态
this.prevStatus 当前的状态
this.canmove 是否可以移动
this.createStage(); 在id为game的容器里面添加画布  
this.env = 'yang'; // 默认环境为阳
this.changetimes = 0; // 切换环境次数

this.datamanager = new datamanager(this);

// 添加太极管理器（新增代码）
this.taijimanager = new TaijiManager(this);

// 传递 datamanager 给 mapmanager
this.mapmanager = new mapmanager(this);
this.inputmanager = new inputmanager(this);
this.hp = new hp(10, this);
this.baguamanager = new BaguaManager(this);
this.achievements = new AchievementsManager(this);
this.cg = false;
this.night = false;

this.entitymanager = new entitymanager(this);
this.eventmanager = new eventmanager(this);
this.savemanager = new SaveManager(this);
this.dialog = new dialog(this);
this.enemymanager = new EnemyManager(this);
this.cgmanager = new CGManager(this);
this.nightmanager = new NightManager(this);
this.soundmanager = new SoundManager(this);


## Util
### Rect类
containsRect函数用来判断是否重合，放回一个布尔值，传入this.rect
> this.rect = new Rect(x, y, width, height);
用这个来初始化一个东西的位置

## datamanager
这个里面定义了地图，json，精灵表的加载
如果想要加载json数据，在外部的js文件中
> let data=await this.game.datamanager.loadJSON(src);
然后这个data就包含了其中的各种类了，直接打点调用


## mapmanager
首先是碰撞箱的地方，这个Tile直接继承了Rect，所以直接传入参数就好了

### mapmanager类
**empty**函数，清理用，但是其他的代码里面有新的定义
**loadmap和loadnewmap**是加载地图用的，这个基本不用改
但是这里面有规定玩家的出生点是在（0，0），如果发现json里面有出生点才更改位置
至于加载地图后出现的事件是依靠with判断的，
**addTeil**是加载碰撞箱的，可以闯入json数据等等
最后的两个for循环时画图用的，对于有碰撞箱的地方是用可以加图片的方式
现在在碰撞箱的那个代码里面，加了hp，也就是说，有hp的方块必须是用图片做的，不然没效果，但是图片的画，这个碰撞箱的大小会自由适配

## inputmanager
专门用来监听的
有一个takeEnter的函数，专门用来看有没有按下enter健
这个文件的函数其实只判断true和false，最终的响应处理在entitymanager里面

move.js里面也有一个Inputmanager，两者的区别只是大小写不一样

## entitymanager
存了一大段静态属性
然后再init里面加了die和床送门的图片

**makesoud**函数是用来播放声音用的，里面做了一个状态检测，然后调用soundmanager的函数来播放声音

**update**函数就是最重要的了
首先是在里面监听的电脑的输入
然后加入了阴阳切换的部分，以及人物的移动部分以及移动时候的动画切换
还有人物与地形的碰撞箱检测

**chcevent()** 用来控制人物的是否传送，这里用的策略是调用eventmanager，把事件add

**checkCollision()** 这个函数用来判断是击败敌人还是自己扣血

**drawPlayer()** 通过调用animationmachine，更改current来操作的，传回来current的状态，同样对于人物触发实践的那个表也是在这里面画的

**drawDeadPlayer** 画玩家的死亡状态

**drawPortals** 画传送门


### eventmanager
核心是**handle函数**，其中除了了很多事件，就是json里面的事件，比如changemap这些就在里面，但是有个night模式，这个好像不是在这里面调用的