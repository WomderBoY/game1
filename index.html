<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>阴阳劫</title>
    <link rel="icon" type="image/svg+xml" href="logo.svg">
    <link rel="shortcut icon" href="logo.svg">
    <link rel="apple-touch-icon" href="logo.svg">
    <link rel="icon" sizes="32x32" href="logo.svg">
    <link rel="icon" sizes="16x16" href="logo.svg">
    <link rel="stylesheet" href="styles/style.css">
</head>

<body>

    <!-- 场景1: 认证界面 (登录/注册) -->
    <div id="auth-screen">
        <canvas id="bg"></canvas>
        <div class="switch-wave" id="switch-wave"></div>
        <div class="slider-wrapper">
            <div class="slider" id="slider">
                <!-- 登录面板 -->
                <div class="panel" id="login-panel">
                    <h2>登录</h2>
                    <input type="text" id="login-username" placeholder="账号">
                    <div style="position:relative;">
                        <input type="password" id="login-password" placeholder="密码">
                        <div class="show-pass-btn" onclick="togglePassword('login-password')">
                            <svg viewBox="0 0 64 64">
                                <path
                                    d="M32 16C18 16 6 32 6 32s12 16 26 16 26-16 26-16S46 16 32 16zm0 26a10 10 0 1 1 0-20 10 10 0 0 1 0 20z" />
                            </svg>
                        </div>
                    </div>
                    <button onclick="login(transitionToMainMenu)">登录</button>
                    <span class="toggle-link" onclick="toggleForm()">没有账号？注册</span>
                </div>
                <!-- 注册面板 -->
                <div class="panel" id="register-panel">
                    <h2>注册</h2>
                    <input type="text" id="register-username" placeholder="账号">
                    <div style="position:relative;">
                        <input type="password" id="register-password" placeholder="密码"
                            oninput="checkPasswordStrength()">
                        <div class="show-pass-btn" onclick="togglePassword('register-password')">
                            <svg viewBox="0 0 64 64">
                                <path
                                    d="M32 16C18 16 6 32 6 32s12 16 26 16 26-16 26-16S46 16 32 16zm0 26a10 10 0 1 1 0-20 10 10 0 0 1 0 20z" />
                            </svg>
                        </div>
                    </div>
                    <div class="strength" id="password-strength"></div>
                    <!-- 新增：确认密码栏 -->
                    <div style="position:relative;">
                        <input type="password" id="register-confirm-password" placeholder="确认密码">
                        <div class="show-pass-btn" onclick="togglePassword('register-confirm-password')">
                            <svg viewBox="0 0 64 64">
                                <path
                                    d="M32 16C18 16 6 32 6 32s12 16 26 16 26-16 26-16S46 16 32 16zm0 26a10 10 0 1 1 0-20 10 10 0 0 1 0 20z" />
                            </svg>
                        </div>
                    </div>
                    <button onclick="register()">注册</button>
                    <span class="toggle-link" onclick="toggleForm()">已有账号？登录</span>
                </div>
            </div>
        </div>
        <div class="popup" id="popup"></div>
    </div>

    <!-- 场景2: 游戏主菜单 (默认隐藏) -->
    <div id="main-menu-screen" class="hidden">
        <a id="goto-main-menu" name="goto-main-menu"></a>
        <svg class="taijitu-bg" viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
            <!-- 第1步: 绘制一个完整的黑色背景圆，作为“阴”的基础 -->
            <circle cx="50" cy="50" r="50" fill="#000" />

            <!-- 第2步: 在黑色圆上方绘制白色的“阳”鱼 -->
            <path d="M50,0 A50,50 0 0,0 50,100 A25,25 0 0,1 50,50 A25,25 0 0,0 50,0 Z" fill="#fff" />

            <!-- 第3步: 绘制两个“鱼眼” -->
            <circle cx="50" cy="25" r="3" fill="#000" /> <!-- 阳鱼中的阴眼 (黑) -->
            <circle cx="50" cy="75" r="3" fill="#fff" /> <!-- 阴鱼中的阳眼 (白) -->
        </svg>
        <div class="menu-panel">
            <h1>阴阳劫</h1>
            <div id="username-display" style="margin-bottom: 20px; font-size: 16px; opacity: 0.8;"></div>
            <button id="start-game-btn">开始游戏</button>
            <button id="achievements-btn">成就系统</button>
            <button id="options-btn">游戏设置</button>
            <button id="about-us">关于我们</button>
            <button id="logout-btn">退出登录</button>
        </div>
    </div>



    <!-- 成就系统弹窗 (默认隐藏) -->
    <div id="achievement-modal" class="hidden">
        <div class="modal-content">
            <span class="modal-close-btn">&times;</span>
            <h2>成就系统</h2>
            <div class="achievement-pagination">
                <button id="prev-page-btn" class="page-btn">‹</button>
                <span id="page-info">1 / 3</span>
                <button id="next-page-btn" class="page-btn">›</button>
            </div>
            <ul class="achievement-list" id="achievement-list">
            </ul>
        </div>
    </div>

    <!-- 游戏设置弹窗 (默认隐藏) -->
    <div id="settings-modal" class="hidden">
        <div class="modal-content settings-content">
            <span class="modal-close-btn" id="settings-close-btn">&times;</span>
            <h2>游戏设置</h2>

            <!-- 音频设置区域 -->
            <div class="settings-section">
                <h3>音频设置</h3>

                <!-- 背景音乐音量 -->
                <div class="volume-control">
                    <label for="main-bgm-volume-slider" class="volume-label">背景音乐音量</label>
                    <div class="volume-container">
                        <input type="range" id="main-bgm-volume-slider" class="volume-slider" min="0" max="100"
                            value="50" step="5">
                        <span id="main-bgm-volume-value" class="volume-value">50%</span>
                    </div>
                </div>

                <!-- 音效音量 -->
                <div class="volume-control">
                    <label for="sfx-volume-slider" class="volume-label">音效音量</label>
                    <div class="volume-container">
                        <input type="range" id="sfx-volume-slider" class="volume-slider" min="0" max="100" value="50"
                            step="5">
                        <span id="sfx-volume-value" class="volume-value">50%</span>
                    </div>
                </div>
            </div>

            <!-- 游戏设置区域 -->
            <div class="settings-section">
                <h3>游戏设置</h3>

                <!-- 删除存档设置 -->
                <div class="setting-item">
                    <label class="setting-label">存档管理</label>
                    <button id="delete-save-btn" class="delete-save-button">删除存档</button>
                    <p class="setting-description">删除当前账号的游戏进度和关卡数据，保留成就数据</p>
                </div>
            </div>
        </div>
    </div>
    <script src="./work/js/bgmmanager.js"></script>
    <script src="./src/auth/auth.js"></script>
    <script>
        if (window.location.hash === '#menu' || window.location.hash === '#goto-main-menu') {
        const authScreen = document.getElementById('auth-screen');
        const mainMenuScreen = document.getElementById('main-menu-screen');
        const sliderWrapper = document.querySelector('.slider-wrapper');
        if (sliderWrapper) sliderWrapper.style.display = 'none';
        if (authScreen) authScreen.style.display = '';
        if (mainMenuScreen) {
            mainMenuScreen.classList.remove('hidden');
            mainMenuScreen.style.opacity = '1';
            updateUsernameDisplay();
        }

        // 强制重新绘制背景动画
        drawBackground(true);
        }
    </script>
</body>

</html>